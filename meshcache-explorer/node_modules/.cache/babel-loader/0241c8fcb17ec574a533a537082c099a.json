{"ast":null,"code":"'use strict';\n\nvar curve = require('../curve');\n\nvar BN = require('bn.js');\n\nvar inherits = require('inherits');\n\nvar Base = curve.base;\n\nvar elliptic = require('../../elliptic');\n\nvar utils = elliptic.utils;\n\nfunction MontCurve(conf) {\n  Base.call(this, 'mont', conf);\n  this.a = new BN(conf.a, 16).toRed(this.red);\n  this.b = new BN(conf.b, 16).toRed(this.red);\n  this.i4 = new BN(4).toRed(this.red).redInvm();\n  this.two = new BN(2).toRed(this.red);\n  this.a24 = this.i4.redMul(this.a.redAdd(this.two));\n}\n\ninherits(MontCurve, Base);\nmodule.exports = MontCurve;\n\nMontCurve.prototype.validate = function validate(point) {\n  var x = point.normalize().x;\n  var x2 = x.redSqr();\n  var rhs = x2.redMul(x).redAdd(x2.redMul(this.a)).redAdd(x);\n  var y = rhs.redSqrt();\n  return y.redSqr().cmp(rhs) === 0;\n};\n\nfunction Point(curve, x, z) {\n  Base.BasePoint.call(this, curve, 'projective');\n\n  if (x === null && z === null) {\n    this.x = this.curve.one;\n    this.z = this.curve.zero;\n  } else {\n    this.x = new BN(x, 16);\n    this.z = new BN(z, 16);\n    if (!this.x.red) this.x = this.x.toRed(this.curve.red);\n    if (!this.z.red) this.z = this.z.toRed(this.curve.red);\n  }\n}\n\ninherits(Point, Base.BasePoint);\n\nMontCurve.prototype.decodePoint = function decodePoint(bytes, enc) {\n  return this.point(utils.toArray(bytes, enc), 1);\n};\n\nMontCurve.prototype.point = function point(x, z) {\n  return new Point(this, x, z);\n};\n\nMontCurve.prototype.pointFromJSON = function pointFromJSON(obj) {\n  return Point.fromJSON(this, obj);\n};\n\nPoint.prototype.precompute = function precompute() {// No-op\n};\n\nPoint.prototype._encode = function _encode() {\n  return this.getX().toArray('be', this.curve.p.byteLength());\n};\n\nPoint.fromJSON = function fromJSON(curve, obj) {\n  return new Point(curve, obj[0], obj[1] || curve.one);\n};\n\nPoint.prototype.inspect = function inspect() {\n  if (this.isInfinity()) return '<EC Point Infinity>';\n  return '<EC Point x: ' + this.x.fromRed().toString(16, 2) + ' z: ' + this.z.fromRed().toString(16, 2) + '>';\n};\n\nPoint.prototype.isInfinity = function isInfinity() {\n  // XXX This code assumes that zero is always zero in red\n  return this.z.cmpn(0) === 0;\n};\n\nPoint.prototype.dbl = function dbl() {\n  // http://hyperelliptic.org/EFD/g1p/auto-montgom-xz.html#doubling-dbl-1987-m-3\n  // 2M + 2S + 4A\n  // A = X1 + Z1\n  var a = this.x.redAdd(this.z); // AA = A^2\n\n  var aa = a.redSqr(); // B = X1 - Z1\n\n  var b = this.x.redSub(this.z); // BB = B^2\n\n  var bb = b.redSqr(); // C = AA - BB\n\n  var c = aa.redSub(bb); // X3 = AA * BB\n\n  var nx = aa.redMul(bb); // Z3 = C * (BB + A24 * C)\n\n  var nz = c.redMul(bb.redAdd(this.curve.a24.redMul(c)));\n  return this.curve.point(nx, nz);\n};\n\nPoint.prototype.add = function add() {\n  throw new Error('Not supported on Montgomery curve');\n};\n\nPoint.prototype.diffAdd = function diffAdd(p, diff) {\n  // http://hyperelliptic.org/EFD/g1p/auto-montgom-xz.html#diffadd-dadd-1987-m-3\n  // 4M + 2S + 6A\n  // A = X2 + Z2\n  var a = this.x.redAdd(this.z); // B = X2 - Z2\n\n  var b = this.x.redSub(this.z); // C = X3 + Z3\n\n  var c = p.x.redAdd(p.z); // D = X3 - Z3\n\n  var d = p.x.redSub(p.z); // DA = D * A\n\n  var da = d.redMul(a); // CB = C * B\n\n  var cb = c.redMul(b); // X5 = Z1 * (DA + CB)^2\n\n  var nx = diff.z.redMul(da.redAdd(cb).redSqr()); // Z5 = X1 * (DA - CB)^2\n\n  var nz = diff.x.redMul(da.redISub(cb).redSqr());\n  return this.curve.point(nx, nz);\n};\n\nPoint.prototype.mul = function mul(k) {\n  var t = k.clone();\n  var a = this; // (N / 2) * Q + Q\n\n  var b = this.curve.point(null, null); // (N / 2) * Q\n\n  var c = this; // Q\n\n  for (var bits = []; t.cmpn(0) !== 0; t.iushrn(1)) {\n    bits.push(t.andln(1));\n  }\n\n  for (var i = bits.length - 1; i >= 0; i--) {\n    if (bits[i] === 0) {\n      // N * Q + Q = ((N / 2) * Q + Q)) + (N / 2) * Q\n      a = a.diffAdd(b, c); // N * Q = 2 * ((N / 2) * Q + Q))\n\n      b = b.dbl();\n    } else {\n      // N * Q = ((N / 2) * Q + Q) + ((N / 2) * Q)\n      b = a.diffAdd(b, c); // N * Q + Q = 2 * ((N / 2) * Q + Q)\n\n      a = a.dbl();\n    }\n  }\n\n  return b;\n};\n\nPoint.prototype.mulAdd = function mulAdd() {\n  throw new Error('Not supported on Montgomery curve');\n};\n\nPoint.prototype.jumlAdd = function jumlAdd() {\n  throw new Error('Not supported on Montgomery curve');\n};\n\nPoint.prototype.eq = function eq(other) {\n  return this.getX().cmp(other.getX()) === 0;\n};\n\nPoint.prototype.normalize = function normalize() {\n  this.x = this.x.redMul(this.z.redInvm());\n  this.z = this.curve.one;\n  return this;\n};\n\nPoint.prototype.getX = function getX() {\n  // Normalize coordinates\n  this.normalize();\n  return this.x.fromRed();\n};","map":{"version":3,"sources":["/Users/chasesmith/Desktop/registry-display/src/node_modules/elliptic/lib/elliptic/curve/mont.js"],"names":["curve","require","BN","inherits","Base","base","elliptic","utils","MontCurve","conf","call","a","toRed","red","b","i4","redInvm","two","a24","redMul","redAdd","module","exports","prototype","validate","point","x","normalize","x2","redSqr","rhs","y","redSqrt","cmp","Point","z","BasePoint","one","zero","decodePoint","bytes","enc","toArray","pointFromJSON","obj","fromJSON","precompute","_encode","getX","p","byteLength","inspect","isInfinity","fromRed","toString","cmpn","dbl","aa","redSub","bb","c","nx","nz","add","Error","diffAdd","diff","d","da","cb","redISub","mul","k","t","clone","bits","iushrn","push","andln","i","length","mulAdd","jumlAdd","eq","other"],"mappings":"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","sourcesContent":["'use strict';\n\nvar curve = require('../curve');\nvar BN = require('bn.js');\nvar inherits = require('inherits');\nvar Base = curve.base;\n\nvar elliptic = require('../../elliptic');\nvar utils = elliptic.utils;\n\nfunction MontCurve(conf) {\n  Base.call(this, 'mont', conf);\n\n  this.a = new BN(conf.a, 16).toRed(this.red);\n  this.b = new BN(conf.b, 16).toRed(this.red);\n  this.i4 = new BN(4).toRed(this.red).redInvm();\n  this.two = new BN(2).toRed(this.red);\n  this.a24 = this.i4.redMul(this.a.redAdd(this.two));\n}\ninherits(MontCurve, Base);\nmodule.exports = MontCurve;\n\nMontCurve.prototype.validate = function validate(point) {\n  var x = point.normalize().x;\n  var x2 = x.redSqr();\n  var rhs = x2.redMul(x).redAdd(x2.redMul(this.a)).redAdd(x);\n  var y = rhs.redSqrt();\n\n  return y.redSqr().cmp(rhs) === 0;\n};\n\nfunction Point(curve, x, z) {\n  Base.BasePoint.call(this, curve, 'projective');\n  if (x === null && z === null) {\n    this.x = this.curve.one;\n    this.z = this.curve.zero;\n  } else {\n    this.x = new BN(x, 16);\n    this.z = new BN(z, 16);\n    if (!this.x.red)\n      this.x = this.x.toRed(this.curve.red);\n    if (!this.z.red)\n      this.z = this.z.toRed(this.curve.red);\n  }\n}\ninherits(Point, Base.BasePoint);\n\nMontCurve.prototype.decodePoint = function decodePoint(bytes, enc) {\n  return this.point(utils.toArray(bytes, enc), 1);\n};\n\nMontCurve.prototype.point = function point(x, z) {\n  return new Point(this, x, z);\n};\n\nMontCurve.prototype.pointFromJSON = function pointFromJSON(obj) {\n  return Point.fromJSON(this, obj);\n};\n\nPoint.prototype.precompute = function precompute() {\n  // No-op\n};\n\nPoint.prototype._encode = function _encode() {\n  return this.getX().toArray('be', this.curve.p.byteLength());\n};\n\nPoint.fromJSON = function fromJSON(curve, obj) {\n  return new Point(curve, obj[0], obj[1] || curve.one);\n};\n\nPoint.prototype.inspect = function inspect() {\n  if (this.isInfinity())\n    return '<EC Point Infinity>';\n  return '<EC Point x: ' + this.x.fromRed().toString(16, 2) +\n      ' z: ' + this.z.fromRed().toString(16, 2) + '>';\n};\n\nPoint.prototype.isInfinity = function isInfinity() {\n  // XXX This code assumes that zero is always zero in red\n  return this.z.cmpn(0) === 0;\n};\n\nPoint.prototype.dbl = function dbl() {\n  // http://hyperelliptic.org/EFD/g1p/auto-montgom-xz.html#doubling-dbl-1987-m-3\n  // 2M + 2S + 4A\n\n  // A = X1 + Z1\n  var a = this.x.redAdd(this.z);\n  // AA = A^2\n  var aa = a.redSqr();\n  // B = X1 - Z1\n  var b = this.x.redSub(this.z);\n  // BB = B^2\n  var bb = b.redSqr();\n  // C = AA - BB\n  var c = aa.redSub(bb);\n  // X3 = AA * BB\n  var nx = aa.redMul(bb);\n  // Z3 = C * (BB + A24 * C)\n  var nz = c.redMul(bb.redAdd(this.curve.a24.redMul(c)));\n  return this.curve.point(nx, nz);\n};\n\nPoint.prototype.add = function add() {\n  throw new Error('Not supported on Montgomery curve');\n};\n\nPoint.prototype.diffAdd = function diffAdd(p, diff) {\n  // http://hyperelliptic.org/EFD/g1p/auto-montgom-xz.html#diffadd-dadd-1987-m-3\n  // 4M + 2S + 6A\n\n  // A = X2 + Z2\n  var a = this.x.redAdd(this.z);\n  // B = X2 - Z2\n  var b = this.x.redSub(this.z);\n  // C = X3 + Z3\n  var c = p.x.redAdd(p.z);\n  // D = X3 - Z3\n  var d = p.x.redSub(p.z);\n  // DA = D * A\n  var da = d.redMul(a);\n  // CB = C * B\n  var cb = c.redMul(b);\n  // X5 = Z1 * (DA + CB)^2\n  var nx = diff.z.redMul(da.redAdd(cb).redSqr());\n  // Z5 = X1 * (DA - CB)^2\n  var nz = diff.x.redMul(da.redISub(cb).redSqr());\n  return this.curve.point(nx, nz);\n};\n\nPoint.prototype.mul = function mul(k) {\n  var t = k.clone();\n  var a = this; // (N / 2) * Q + Q\n  var b = this.curve.point(null, null); // (N / 2) * Q\n  var c = this; // Q\n\n  for (var bits = []; t.cmpn(0) !== 0; t.iushrn(1))\n    bits.push(t.andln(1));\n\n  for (var i = bits.length - 1; i >= 0; i--) {\n    if (bits[i] === 0) {\n      // N * Q + Q = ((N / 2) * Q + Q)) + (N / 2) * Q\n      a = a.diffAdd(b, c);\n      // N * Q = 2 * ((N / 2) * Q + Q))\n      b = b.dbl();\n    } else {\n      // N * Q = ((N / 2) * Q + Q) + ((N / 2) * Q)\n      b = a.diffAdd(b, c);\n      // N * Q + Q = 2 * ((N / 2) * Q + Q)\n      a = a.dbl();\n    }\n  }\n  return b;\n};\n\nPoint.prototype.mulAdd = function mulAdd() {\n  throw new Error('Not supported on Montgomery curve');\n};\n\nPoint.prototype.jumlAdd = function jumlAdd() {\n  throw new Error('Not supported on Montgomery curve');\n};\n\nPoint.prototype.eq = function eq(other) {\n  return this.getX().cmp(other.getX()) === 0;\n};\n\nPoint.prototype.normalize = function normalize() {\n  this.x = this.x.redMul(this.z.redInvm());\n  this.z = this.curve.one;\n  return this;\n};\n\nPoint.prototype.getX = function getX() {\n  // Normalize coordinates\n  this.normalize();\n\n  return this.x.fromRed();\n};\n"]},"metadata":{},"sourceType":"module"}